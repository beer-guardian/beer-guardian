(function(){function e(e){var a=e.ibu;e.ibu.length>3&&(a=e.ibu.slice(0,-2)),$(".active-beer-modal").attr("id",e.id),$(".active-beer-modal .header .title").html(e.name),$(".active-beer-modal .brewery").html(e.brewery),$(".active-beer-modal .body p").html(e.desc),$(".active-beer-modal .widget.abv .number").html(e.abv),$(".active-beer-modal .widget.ibu .number").html(a),$(".active-beer-modal .widget.score .number").html(e.score),$(".active-beer-modal .image").css("background-image",e.label),$(".modal-cover").fadeIn("fast"),$(".active-beer-modal").addClass("reveal")}function a(){$(".modal-cover").fadeIn("fast"),$(".add-beer-modal").addClass("reveal")}function t(){$(".add-beer-modal ul").empty(),$("#input-beer-search").val(""),$("#input-beer-search").removeClass("disabled"),$(".modal-cover").fadeOut("fast"),$(".modal").removeClass("reveal")}function i(e){$(".add-beer-modal ul").empty();var a="/api/v1/search?q="+e;""!==e&&$.get(a,function(a){$.each(a,function(e,a){a.breweries&&$(".add-beer-modal ul").append('<li data-id="'+a.id+'"><div>'+a.name+'</div><div class="small">'+a.breweries[0].name+"</div></li>")}),$(".add-beer-modal ul").append("<li data-name='"+e+"'><div>'"+e+"'</div><div class='small'>Don't see what you want? Submit your current search term.</div></li>")})}function r(e,a){$.post("/api/v1/request",{beer:a,name:e}).done(function(e){$(".add-beer-modal ul").empty(),$("#input-beer-search").val("Beer requested, thank you."),$("#input-beer-search").addClass("disabled")})}function d(e,a){$.post("/api/v1/vote",{beer:e,vote:a}).done(function(a){o(e)})}function n(){$(".card .score span").each(function(){var e=parseFloat($(this).text());e<0?$(this).addClass("negative"):$(this).removeClass("negative")})}function o(e){var a="/api/v1/beers/"+e;$.get(a,function(a){$("#"+e+" .score span").html(a.score),$("#"+e).attr("data-score",a.score),$("#"+e+".active-beer-modal .score .number").html(a.score),n()})}function c(){var e=navigator.userAgent.toLowerCase();if(e.indexOf("safari")!=-1)return!(e.indexOf("chrome")>-1)}$(function(){if("/"==window.location.pathname){if($("#pass + .close").on("click",function(){$("#pass").val("")}),n(),!c()){$(".js-tilt").tilt({glare:!0,maxGlare:.3,speed:400,scale:1,maxTilt:10,perspective:500})}$("#input-beer-search").keypress(function(e){if(13==e.which)return i($("#input-beer-search").val()),!1}),$(".beer-cards .card-active").click(function(){var a={name:$(this).find(".title").text(),brewery:$(this).find(".meta").text(),desc:$(this).find(".desc").text(),abv:$(this).attr("data-abv"),ibu:$(this).attr("data-ibu"),id:$(this).attr("data-id"),score:$(this).attr("data-score"),label:$(this).css("background-image")};e(a)}),$(".card .vote-up").click(function(e){var a=$(this).parent().parent().attr("data-id");d(a,"UP"),e.stopPropagation()}),$(".card .vote-down").click(function(e){var a=$(this).parent().parent().attr("data-id");d(a,"DOWN"),e.stopPropagation()}),$(".active-beer-modal .vote-up").click(function(){var e=$(".active-beer-modal").attr("id");d(e,"UP")}),$(".active-beer-modal .vote-down").click(function(){var e=$(".active-beer-modal").attr("id");d(e,"DOWN")}),$(".beer-cards .card-add").click(function(){a(),setTimeout(function(){$("#input-beer-search").focus()},100)}),$(".modal-cover").click(function(){t()}),$(".modal-close").click(function(){t()})}else if("/admin"==window.location.pathname){var r=$(".tabs > .active"),o=$(".tab__content"),s=o.find(".active"),l=s.outerHeight();s.show(),o.height(l),$(".tabs > li").on("click",function(){$(".tabs > li").removeClass("active"),$(this).addClass("active"),r=$(".tabs .active"),s.fadeOut(250,function(){$(".tab__content > li").removeClass("active");var e=r.index();$(".tab__content > li").eq(e).addClass("active"),s=$(".tab__content > .active"),l=s.outerHeight(),o.stop().delay(50).animate({height:l},500,function(){s.delay(50).fadeIn(250)})})});var v=$(".colors li");v.on("click",function(){$(".colors > li").removeClass("active-color"),$(this).addClass("active-color");var e=$(this).attr("data-color");$(".bg-color").css("background-color",e),$(".text-color").css("color",e)}),$.get("/api/v1/beers",function(e){$.each(e,function(e,a){$(".admin .beers-table").append('<tr><td><a href="/admin/forms/beer/'+a._id+'">'+a._id+"</a></td><td>"+a.name+"</td><td>"+a.brewery+"</td><td>"+a.brewerydbId+"</td><td>"+a.score+"</td></tr>")})}),$.get("/api/v1/admin/requests",function(e){$.each(e,function(e,a){$(".admin .requests-table").append("<tr><td>"+a._id+"</td><td>"+a.name+"</td><td>"+a.brewerydbId+'</td><td><a class="approve-link" href="/admin/forms/request/'+a._id+'">APPROVE</a><a class="approve-link deny" href="/admin/forms/deny/'+a._id+'">DENY</a></td></tr>')})}),$.get("/api/v1/admin/users",function(e){$.each(e,function(e,a){$(".admin .users-table").append("<tr><td>"+a._id+"</td><td>"+a.email+"</td><td>"+a.admin+"</td></tr>")})})}}),$("body").on("click",".add-beer-modal li",function(){var e=$(this).attr("data-name");void 0==e&&(e=null);var a=$(this).attr("data-id");void 0==a&&(a=null),r(e,a)})})();