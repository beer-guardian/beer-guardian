(function(){function e(e){console.log(e),$(".active-beer-modal").attr("id",e.id),$(".active-beer-modal .header .title").html(e.name),$(".active-beer-modal .brewery").html(e.brewery),$(".active-beer-modal .body p").html(e.desc),$(".active-beer-modal .widget.abv .number").html(e.abv),$(".active-beer-modal .widget.ibu .number").html(e.ibu),$(".active-beer-modal .widget.score .number").html(e.score),$(".active-beer-modal .image").css("background-image",e.label),$(".modal-cover").fadeIn("fast"),$(".active-beer-modal").addClass("reveal")}function a(){$(".modal-cover").fadeIn("fast"),$(".add-beer-modal").addClass("reveal")}function t(){$(".add-beer-modal ul").empty(),$("#input-beer-search").val(""),$("#input-beer-search").removeClass("disabled"),$(".modal-cover").fadeOut("fast"),$(".modal").removeClass("reveal")}function i(e){$(".add-beer-modal ul").empty();var a="/api/v1/search?q="+e;""!==e&&$.get(a,function(a){$.each(a,function(e,a){$(".add-beer-modal ul").append('<li data-id="'+a.id+'"><div>'+a.name+'</div><div class="small">'+a.breweries[0].name+"</div></li>")}),$(".add-beer-modal ul").append("<li data-name='"+e+"'><div>'"+e+"'</div><div class='small'>Don't see what you want? Submit your current search term.</div></li>")})}function r(e,a){$.post("/api/v1/request",{beer:a,name:e}).done(function(e){$(".add-beer-modal ul").empty(),$("#input-beer-search").val("Beer requested, thank you."),$("#input-beer-search").addClass("disabled")})}function o(e,a){$.post("/api/v1/vote",{beer:e,vote:a}).done(function(a){c(e)})}function d(){$(".card .score span").each(function(){console.log("here");var e=parseFloat($(this).text());e<0?$(this).addClass("negative"):$(this).removeClass("negative")})}function c(e){var a="/api/v1/beers/"+e;$.get(a,function(a){console.log(a.score),$("#"+e+" .score span").html(a.score),$("#"+e).attr("data-score",a.score),$("#"+e+".active-beer-modal .score .number").html(a.score),d()})}function n(){var e=navigator.userAgent.toLowerCase();if(e.indexOf("safari")!=-1)return!(e.indexOf("chrome")>-1)}$(function(){$("#pass + .close").on("click",function(){$("#pass").val("")}),d();$(".js-tilt").tilt({glare:!n(),maxGlare:n()?0:.3,speed:400,scale:1,maxTilt:10,perspective:500});$("#input-beer-search").keypress(function(e){if(13==e.which)return i($("#input-beer-search").val()),!1}),$(".beer-cards .card-active").click(function(){var a={name:$(this).find(".title").text(),brewery:$(this).find(".meta").text(),desc:$(this).find(".desc").text(),abv:$(this).attr("data-abv"),ibu:$(this).attr("data-ibu"),id:$(this).attr("data-id"),score:$(this).attr("data-score"),label:$(this).css("background-image")};e(a)}),$(".card .vote-up").click(function(e){var a=$(this).parent().parent().attr("data-id");o(a,"UP"),e.stopPropagation()}),$(".card .vote-down").click(function(e){var a=$(this).parent().parent().attr("data-id");o(a,"DOWN"),e.stopPropagation()}),$(".active-beer-modal .vote-up").click(function(){var e=$(".active-beer-modal").attr("id");console.log(e),o(e,"UP")}),$(".active-beer-modal .vote-down").click(function(){var e=$(".active-beer-modal").attr("id");console.log(e),o(e,"DOWN")}),$(".beer-cards .card-add").click(function(){a(),setTimeout(function(){$("#input-beer-search").focus()},100)}),$(".modal-cover").click(function(){t()}),$(".modal-close").click(function(){t()})}),$("body").on("click",".add-beer-modal li",function(){var e=$(this).attr("data-name");void 0==e&&(e=null);var a=$(this).attr("data-id");void 0==a&&(a=null),r(e,a)})})();